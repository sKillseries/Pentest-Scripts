#!/bin/bash

cible=$1
interface=$2

if [ ! -d "resultats" ];then
    mkdir resultats
fi
if [ ! -d "resultats/sysrecon.txt"];then
    touch resultats/sysrecon.txt
fi

echo "[*] ARP active discovering..."
echo "[#] ARP scan result" >> resultats/sysrecon.txt
nmap -sn $cible >> resultats/sysrecon.txt

echo "[*] NBT discovering..."
echo "[#] NBT scan result" >> resultats/sysrecon.txt
nbtscan -r $cible >> resultats/sysrecon.txt

echo "[*] ICMP discovering..."
echo "[#] ICMP scan result" >> resultats/sysrecon.txt
nmap -PE -PP -PM -sP $cible >> resultats/sysrecon.txt

echo "[*] TCP Port scanning..."
echo "[#] TCP port scan result" >> resultats/sysrecon.txt
nmap -Pn --script vuln -sV -p "0-65535" $cible >> resultats/sysrecon.txt

echo "[*] Double Checking Port Scanning..."
echo "[#] masscan result" >> resultats/sysrecon.txt 
masscan -e $interface -p0-65535,U:0-65535 --max-rate 100000 $cible >> resultats/sysrecon.txt

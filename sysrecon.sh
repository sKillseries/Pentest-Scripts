#!/bin/bash

enterprise=$1
cible=$2
interface=$3

if [ ! -d "$enterprise" ];then
    mkdir $enterprise
fi
if [ ! -d "$enterprise/recon" ];then
    mkdir $enterprise/recon
fi
if [ ! -d "$enterprise/recon/sys" ];then
    mkdir $enterprise/recon/sys
fi

echo "[*] ARP active discovering..."
nmap -sn $cible >> $enterprise/recon/sys/arp_nmap.txt

echo "[*] NBT discovering..."
nbtscan -r $cible >> $enterprise/recon/sys/nbt.txt

echo "[*] ICMP discovering..."
nmap -PE -PP -PM -sP $cible >> $enterprise/recon/sys/icmp.txt

echo "[*] TCP Port scanning..."
nmap -Pn --script vuln -sV -p "0-65535" $cible >> $enterprise/recon/sys/portscanning.txt

echo "[*] Double Checking Port Scanning..."
masscan -e $interface -p0-65535,U:0-65535 --max-rate 100000 $cible >> $enterprise/recon/sys/portscanning2.txt
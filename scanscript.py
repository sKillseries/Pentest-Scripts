#!/usr/bin/python3

#############################################################################################################################
# author: sKillseries
# Ce script permet d'automatiser la phase scan d'hôte et a pour but d'améliorer mes méthodologies en termes de pentest
#############################################################################################################################

import os

def sctp():
    print("""
> 1: nmap SCTP FastScan
> 2: nmap SCTP AllScan 
    """)
    choix = input("Veuillez sélectionner une option: ")
    if choix == "1":
        os.system(f"nmap -T4 -sY -n -oA SCTFastScan {target} > sctp_nmap.txt")
        print(f"Le résultat a été enregistré dans le fichier sctp_nmap.txt situé dans le répertoire {enterprise}")
        proceed()
    elif choix == "2":
        os.system(f"nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan {target} > sctp_nmap.txt")
        print(f"Le résultat a été enregistré dans le fichier sctp_nmap.txt situé dans le répertoire {enterprise}")
        proceed()
    else:
        print("Je n'ai pas compris votre demande veuillez sélectionner une des options")
        sctp()

def udp():
    print("""
> 1: nmap fast check (100 port udp les plus commun)
> 2: nmap check (100 port udp les plus commun)
> 3: nmap fast (top 1000 ports udp)
    """)
    choix = input("Veuillez sélectionner une option: ")
    if choix == "1":
        os.system(f"nmap -sU -sV --version-intensity 0 -n -F -T4 {target} > udp_nmap.txt")
        print(f"Le résultat a été enregistré dans le fichier udp_nmap.txt situé dans le répertoire {enterprise}")
        proceed()
    elif choix == "2":
        os.system(f"nmap -sU -sV -sC -n -F -T4 {target} > udp_nmap.txt")
        print(f"Le résultat a été enregistré dans le fichier udp_nmap.txt situé dans le répertoire {enterprise}")
        proceed()
    elif choix == "3":
        os.system(f"nmap -sU -sV --version-intensity 0 -n -T4 {target} > udp_nmap.txt")
        print(f"Le résultat a été enregistré dans le fichier udp_nmap.txt situé dans le répertoire {enterprise}")
        proceed()
    else:
        print("Je n'ai pas compris votre demande veuillez sélectionner une des options")
        udp()

def tcp():
    print("""
Avec quel outil voulez vous le scan ?
> 1: nmap
> 2: bettercap
> q: Quitter
    """)
    choix = input("Veuillez sélectionner une option: ")
    if choix == "1":
        print("""
Quel type de scan voulez-vous faire ?
> 1: fastscan (1000 ports les plus utilisé)
> 2: fullfastscan (Tous les ports)
> 3: fastscan (sans T4)
        """)
        option = input("Veuillez sélectionner une option: ")
        if option == "1":
            os.system(f"nmap -sV -sC -O -T4 -n -Pn -oA fastscan  {target} > tcp_nmap.txt")
            print(f"Le résultat a été enregistré dans le fichier tcp_nmap.txt situé dans le répertoire {enterprise}")
            proceed()
        elif option == "2":
            os.system(f"nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan {target} > tcp_nmap.txt")
            print(f"Le résultat a été enregistré dans le fichier tcp_nmap.txt situé dans le répertoire {enterprise}")
            proceed()
        elif option == "3":
            os.system(f"nmap -sV -sC -O -p- -n -Pn -oA fullscan {target} > tcp_nmap.txt")
            print(f"Le résultat a été enregistré dans le fichier tcp_nmap.txt situé dans le répertoire {enterprise}")
            proceed()
        else:
            print("Je n'ai pas compris votre demande veuillez sélectionner une des options")
            tcp()
    elif choix == "2":
        os.system(f"syn.scan {target} 1 10000 > tcp_bettercap.txt")
        print(f"Le résultat a été enregistré dans le fichier tcp_bettercap.txt situé dans le répertoire {enterprise}")
        proceed()
    else:
        print("Je n'ai pas compris votre demande veuillez sélectionner une des options")
        tcp()

def proceed():
    proceed = input("Voulez-vous continuer ? Y/N: ")
    if proceed == "y":
        menu()
    elif proceed == "Y":
        menu()
    elif proceed == "N":
        print("fermeture du programme")
        exit(0)
    elif proceed == "n":
        print("fermeture du programme")
        exit(0)
    else:
        print("Je n'ai pas compris votre demande veuillez sélectionner une des options")
        proceed()

def menu():
    print("""
Que voulez faire ?
> 1: TCP
> 2: UDP
> 3: SCTP
> q: Quitter
    """)
    choix = input("Veullez sélectionner une option: ")
    if choix == "1":
        tcp()
    elif choix == "2":
        udp()
    elif choix == "3":
        sctp()
    elif choix == "q":
        print("Fermeture du programme")
        exit(0)
    else:
        print("Veuillez sélectionner une option présente dans la liste")
        menu()

def main():
    global enterprise
    global target
    enterprise = input("Quel est le nom de l'entreprise que vous soouhaitez auditer ?: ")
    target = input("Entrez l'adresse IP hôte cible: ")
    os.makedirs(enterprise, exist_ok=True)
    print(f"Le répertoire {enterprise} a été créé")
    menu()

if __name__ == '__main__':
    main()
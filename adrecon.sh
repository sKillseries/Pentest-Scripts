#!/bin/bash

enterprise=$1
cible=$2

if [ ! -d "$enterprise" ];then
    mkdir $enterprise
fi
if [ ! -d "$enterprise/recon" ];then
    mkdir $enterprise/recon
fi
if [ ! -d "$enterprise/recon/ad" ];then
    mkdir $enterprise/recon/ad
fi

echo "[*] DHCP Checking..."
nmap --script broadcast-dhcp-discover >> $enterprise/recon/ad/dhcp.txt

echo "[*] DNS checking..."
nmap --script dns-srv-enum --script-args dns-srv-enum.domain=$cible >> $enterprise/recon/ad/dns.txt

echo "[*] Disvovering DNS nameservers..."
nmap -v -sV -p 53 $cible/$mask >> $enterprise/recon/ad/dns-nameservers.txt
nmap -v -sV -sU -p 53 $cible/$mask >> $enterprise/recon/ad/dns-nameservers.txt

echo "[*] Reverse lookups PTR"
dnsrecon -r $range -n $cible >> $enterprise/recon/ad/reverse-lookups.txt

echo "[*] nbt-ns scanning..."
nbtscan -r $cible/$mask >> $enterprise/recon/ad/nbtscan.txt
nmblookup -A $cible >> $enterprise/recon/ad/nmblookup.txt

echo "[*] Port scanning..."
nmap -sS -n --open -p 88,389 $cible >> $enterprise/recon/ad/portscanning.txt

## LDAP to do

## MS-RPC to do

echo "[*] enum4linux checking..."
enum4linux-ng.py -A $cible

## password policy to do
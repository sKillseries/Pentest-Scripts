#!/bin/bash

enterprise=$1
cible=$2

if [ ! -d "$enterprise" ];then
    mkdir $enterprise
fi
if [ ! -d "$enterprise/recon" ];then
    mkdir $enterprise/recon
fi
if [ ! -d "$enterprise/recon/ad" ];then
    mkdir $enterprise/recon/ad
fi

echo "[*] DHCP Checking..."
nmap --script broadcast-dhcp-discover >> $enterprise/recon/ad/dhcp.txt

echo "[*] DNS checking..."
nmap --script dns-srv-enum --script-args dns-srv-enum.domain=$cible >> $enterprise/recon/ad/dns.txt

echo "[*] Disvovering DNS nameservers..."
nmap -v -sV -p 53 $subnet/$mask >> $enterprise/recon/ad/dns-nameservers.txt
nmap -v -sV -sU -p 53 $subnet/$mask >> $enterprise/recon/ad/dns-nameservers.txt

echo "[*] Reverse lookups PTR"
dnsrecon -r $range -n $cible >> reverse-lookups.txt

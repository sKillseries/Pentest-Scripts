#!/bin/bash

cible=$1
cidr=$2

if [ ! -d "resultats" ];then
    mkdir resultats
fi
if [ ! -d "resultats/netscan.md" ];then
    touch resultats/netscan.md
fi

echo -e "# Inside multihosts network scan\n" >> resultats/netscan.md

echo "ICMP Port Scanning"
{
    echo -e "## Inside multihosts ICMP Port Scanning Result\n"
    echo '```'
    nmap -PE -PM -PP -sn -vvv -n "$cible"/"$cidr"
    echo -e '```\n'
} >> resultats/netscan.md

echo "TCP Port Scanning"
{
    echo -e "## Inside multihosts TCP Port Scanning Result\n"
    echo '```'
    nmap -sV -sC -O -n -Pn -p- -oA fullfastscan "$cible"/"$cidr"
    echo -e '```\n'
} >> resultats/netscan.md

echo "HTTP Port Scanning"
{
    echo -e "## Inside multihosts HTTP Port Scanning Result\n"
    echo '```'
    masscan --banners -p80,443,8000-8100,8443 "$cible"/"$cidr"
    echo -e '```\n'
} >> resultats/netscan.md

echo "UDP Port Scanning"
{
    echo -e "## Inside multihosts UDP Port Scanning Result\n"
    echo '```'
    nmap -sU -sV --version-intensity 0 -n "$cible"/"$cidr"
    echo -e '```\n'
} >> resultats/netscan.md

echo "SCTP Port Scanning"
{
    echo -e "## Inside multihosts SCTP Port Scanning Result\n"
    echo '```'
    nmap -p- -sY -sV -sC -F -n -oA SCTAllScan "$cible"/"$cidr"
    echo -e '```\n'
} >> resultats/netscan.md

echo "DHCP Scanning"
{
    echo -e "## DHCP multihosts Scanning Result\n"
    echo '```'
    nmap --script broadcast-dhcp-discover
    echo -e '```\n'
} >> resultats/netscan.md